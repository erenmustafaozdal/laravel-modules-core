var ModelIndex,Index={options:{},init:function(t){ModelIndex=this,this.options=$.extend(!0,this.getDefaultOptions(),t),this.options.DataTable.datatableFilterSupport&&LMCApp.initDatepicker(),DataTable.init(this.options.DataTable),Editor.init(this.options.Editor),$(DataTable.tableOptions.src+" tbody").on("click","tr td ul.dropdown-menu a.fast-publish",function(){var t=$(this).closest("tr"),a=theDataTable.getDataTable(),e=a.row(t);$.ajax({url:e.data().urls.publish,success:function(t){return"success"===t.result?void LMCApp.getNoty({message:LMCApp.lang.admin.flash.publish_success.message,title:LMCApp.lang.admin.flash.publish_success.title,type:"success"}):void LMCApp.getNoty({message:LMCApp.lang.admin.flash.publish_error.message,title:LMCApp.lang.admin.flash.publish_error.title,type:"error"})}}).done(function(t){"success"===t.result&&(LMCApp.hasTransaction=!1,a.draw())})}),$(DataTable.tableOptions.src+" tbody").on("click","tr td ul.dropdown-menu a.fast-not-publish",function(){var t=$(this).closest("tr"),a=theDataTable.getDataTable(),e=a.row(t);$.ajax({url:e.data().urls.not_publish,success:function(t){return"success"===t.result?void LMCApp.getNoty({message:LMCApp.lang.admin.flash.not_publish_success.message,title:LMCApp.lang.admin.flash.not_publish_success.title,type:"success"}):void LMCApp.getNoty({message:LMCApp.lang.admin.flash.not_publish_error.message,title:LMCApp.lang.admin.flash.not_publish_error.title,type:"error"})}}).done(function(t){"success"===t.result&&(LMCApp.hasTransaction=!1,a.draw())})})},getDefaultOptions:function(){return{DataTable:{src:".lmcDataTable",exportTitle:"Personeller",datatableIsResponsive:!0,groupActionSupport:!0,rowDetailSupport:!0,datatableFilterSupport:!0,exportColumnSize:6,exportOptionsFormat:{body:function(t,a,e){return LMCApp.stripTags(t)}},changeExportColumn:function(){theDataTable.options.exportOptions.columns.splice(1,1)},isRelationTable:!1,changeRelationTable:function(){},onSuccess:function(t,a){},onError:function(t){},onDataLoad:function(t){},onDeleteError:function(t){},getDetailTableFormat:function(t){var a='<table class="table table-hover table-light"><tbody><tr><td style="width:150px; text-align:right;"> <strong>Departman:</strong> </td><td class="text-left">',e="";return $.each(t.categories,function(t,a){e+=a.name+", "}),e=e.substring(0,e.length-2),a+=e,a+='</td></tr><tr><td style="width:150px; text-align:right;"> <strong>Görev:</strong> </td><td class="text-left">'+(null==t.task?"":t.task)+'</td></tr></tr><tr><td style="width:150px; text-align:right;"> <strong>Ad:</strong> </td><td class="text-left">'+(t.first_name+" "+t.last_name)+'</td></tr><tr><td style="width:150px; text-align:right;"> <strong>Açıklama:</strong> </td><td class="text-left">'+(null==t.description?"":t.description)+"</td></tr>",a+='</td></tr><tr><td style="width:150px; text-align:right;"> <strong>Telefon:</strong> </td><td class="text-left">'+(null==t.phone?"":t.phone.phone)+"</td></tr>",a+='</td></tr><tr><td style="width:150px; text-align:right;"> <strong>E-Posta:</strong> </td><td class="text-left">'+(null==t.email?"":t.email.email)+'</td></tr><tr><td style="width:150px; text-align:right;"> <strong>Sosyal Hesaplar:</strong> </td><td class="text-left">',t.social_accounts.length>0&&(a+='<table class="child-table table table-striped table-bordered table-advance table-hover"><thead><tr><th> Başlık </th><th> Hesap </th></tr></thead><tbody>',$.each(t.social_accounts,function(t,e){a+='<tr><td class="highlight"> <div class="warning"> </div>'+e.name+'</td><td><a href="'+e.url+'">'+e.url+"</a></td></tr>"}),a+="</tbody></table>"),a+="</td></tr>"},exportOptions:{columns:[]},dataTable:{columns:[{data:"id",name:"id",className:"text-center"},{data:"photo",name:"photo",searchable:!1,orderable:!1,className:"text-center",render:function(t,a,e,s){return'<img src="'+t+'" width="35" class="img-circle">'}},{data:"fullname",name:"first_name"},{data:"categories",name:"categories",orderable:!1,render:function(t,a,e,s){var n="";return $.each(t,function(t,a){n+='<a href="'+categoryURL.replace("###id###",a.id)+'"> '+a.name+" </a>, "}),n=n.substring(0,n.length-2)}},{data:"task",name:"task"},{data:"status",name:"is_publish",className:"text-center",render:function(t,a,e,s){return t?'<span class="label label-success"> Yayında </span>':'<span class="label label-danger"> Yayında Değil </span>'}},{data:{_:"created_at.display",sort:"created_at.timestamp"},name:"created_at",className:"text-center"},{data:"action",name:"action",searchable:!1,orderable:!1,className:"text-center",render:function(t,a,e,s){var n={id:e.id,showUrl:e.urls.show,buttons:[{title:'<i class="fa fa-pencil"></i> '+LMCApp.lang.admin.ops.fast_edit,attributes:{href:"#editor-modal","data-toggle":"modal","data-action":"fast-edit","data-id":e.id}},{title:'<i class="fa fa-pencil"></i> '+LMCApp.lang.admin.ops.edit,attributes:{href:e.urls.edit_page}},{title:'<i class="fa fa-trash"></i> '+LMCApp.lang.admin.ops.destroy,attributes:{href:"javascript:;","class":"fast-destroy"}},"divider"]};return n.buttons.push({title:e.status?'<i class="fa fa-times"></i> '+LMCApp.lang.admin.ops.not_publish:'<i class="fa fa-check"></i> '+LMCApp.lang.admin.ops.publish,attributes:{href:"javascript:;","class":e.status?"fast-not-publish":"fast-publish"}}),theDataTable.getActionMenu(n)}}],ajax:{url:ajaxURL}}},Editor:{modalShowCallback:function(t){},actionButtonCallback:function(t){$script(formLoaderJs,"formLoader"),$script.ready(["formLoader","validation"],function(){$script(formJs,"form")}),$script.ready("form",function(){ModelForm.init({isAjax:!0,submitAjax:function(a){var e,s,n,i,l,r,o={category_id:a.form.find('select[name="category_id[]"]').val(),first_name:a.form.find('input[name="first_name"]').val(),last_name:a.form.find('input[name="last_name"]').val(),is_publish:a.form.find('input[name="is_publish"]').bootstrapSwitch("state")};"fast-add"===t.actionType?(s="POST",e=apiStoreURL,n=LMCApp.lang.admin.flash.store_success.message,i=LMCApp.lang.admin.flash.store_success.title,l=LMCApp.lang.admin.flash.store_error.message,r=LMCApp.lang.admin.flash.store_error.title):(s="PATCH",e=t.row.data().urls.edit,n=LMCApp.lang.admin.flash.update_success.message,i=LMCApp.lang.admin.flash.update_success.title,l=LMCApp.lang.admin.flash.update_error.message,r=LMCApp.lang.admin.flash.update_error.title),$.ajax({url:e,data:o,type:s,success:function(a){return"success"===a.result?(LMCApp.getNoty({message:n,title:i,type:"success"}),void t.modal.modal("hide")):void LMCApp.getNoty({message:l,title:r,type:"error"})}}).done(function(t){"success"===t.result&&(LMCApp.hasTransaction=!1,DataTable.dataTable.ajax.reload())})}}),$(t.editorOptions.formSrc).submit()})}}}}};