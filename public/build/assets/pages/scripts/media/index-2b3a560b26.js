var ModelIndex,Index={options:{},fileinputOptions:{uploadUrl:apiStoreURL,allowedFileExtensions:validExtension.split(","),allowedFileTypes:null,previewFileType:"any",showUpload:!1,showCancel:!1,fileActionSettings:{showUpload:!1},uploadExtraData:function(t,e){var a=$(".form");return{category_id:null==a.find('select[name="category_id[]"]').val()?a.find('input[name="category_id[]"]').val():a.find('select[name="category_id[]"]').val(),title:a.find('input[name="title"]').val(),description:a.find('textarea[name="description"]').length<1?"":a.find('textarea[name="description"]').val(),is_publish:a.find('input[name="is_publish"]').bootstrapSwitch("state"),x:$("input[name='x[]']").map(function(){return $(this).val()}).get(),y:$("input[name='y[]']").map(function(){return $(this).val()}).get(),width:$("input[name='width[]']").map(function(){return $(this).val()}).get(),height:$("input[name='height[]']").map(function(){return $(this).val()}).get()}},ajaxSettings:{success:function(t){var e,a,s,i;return"fast-add"===Editor.actionType?(e=LMCApp.lang.admin.flash.store_success.message,a=LMCApp.lang.admin.flash.store_success.title,s=LMCApp.lang.admin.flash.store_error.message,i=LMCApp.lang.admin.flash.store_error.title):(e=LMCApp.lang.admin.flash.update_success.message,a=LMCApp.lang.admin.flash.update_success.title,s=LMCApp.lang.admin.flash.update_error.message,i=LMCApp.lang.admin.flash.update_error.title),"success"===t.result?(LMCApp.getNoty({message:e,title:a,type:"success"}),Editor.modal.modal("hide"),LMCApp.hasTransaction=!1,void DataTable.dataTable.ajax.reload()):void LMCApp.getNoty({message:s,title:i,type:"error"})}}},init:function(t){ModelIndex=this,this.options=$.extend(!0,this.getDefaultOptions(),t),this.options.DataTable.datatableFilterSupport&&LMCApp.initDatepicker(),DataTable.init(this.options.DataTable),Editor.init(this.options.Editor),LMCFileinput.init(this.options.Fileinput),$(DataTable.tableOptions.src+" tbody").on("click","tr td ul.dropdown-menu a.fast-publish",function(){var t=$(this).closest("tr"),e=theDataTable.getDataTable(),a=e.row(t);$.ajax({url:a.data().urls.publish,success:function(t){return"success"===t.result?void LMCApp.getNoty({message:LMCApp.lang.admin.flash.publish_success.message,title:LMCApp.lang.admin.flash.publish_success.title,type:"success"}):void LMCApp.getNoty({message:LMCApp.lang.admin.flash.publish_error.message,title:LMCApp.lang.admin.flash.publish_error.title,type:"error"})}}).done(function(t){"success"===t.result&&(LMCApp.hasTransaction=!1,e.draw())})}),$(DataTable.tableOptions.src+" tbody").on("click","tr td ul.dropdown-menu a.fast-not-publish",function(){var t=$(this).closest("tr"),e=theDataTable.getDataTable(),a=e.row(t);$.ajax({url:a.data().urls.not_publish,success:function(t){return"success"===t.result?void LMCApp.getNoty({message:LMCApp.lang.admin.flash.not_publish_success.message,title:LMCApp.lang.admin.flash.not_publish_success.title,type:"success"}):void LMCApp.getNoty({message:LMCApp.lang.admin.flash.not_publish_error.message,title:LMCApp.lang.admin.flash.not_publish_error.title,type:"error"})}}).done(function(t){"success"===t.result&&(LMCApp.hasTransaction=!1,e.draw())})})},getDefaultOptions:function(){return{DataTable:{src:".lmcDataTable",exportTitle:"Medyalar",datatableIsResponsive:!0,groupActionSupport:!0,rowDetailSupport:!0,datatableFilterSupport:!0,exportColumnSize:6,exportOptionsFormat:{body:function(t,e,a){return LMCApp.stripTags(t)}},changeExportColumn:function(){theDataTable.options.exportOptions.columns.splice(1,1)},isRelationTable:!1,changeRelationTable:function(){},onSuccess:function(t,e){},onError:function(t){},onDataLoad:function(t){},onDeleteError:function(t){},onGroupBeforeAjax:function(t){var e=t.action;if("create_album"!==e)return!0;var a=t.id.join(","),s=categoryCreateUrl+"&media_ids="+a;return window.location.href=s,!1},getDetailTableFormat:function(t){var e='<table class="table table-hover table-light"><tbody><tr><td style="width:150px; text-align:right;"> <strong>Albümler:</strong> </td><td class="text-left">',a="";return $.each(t.categories,function(t,e){a+=e.name+", "}),a=a.substring(0,a.length-2),e+=a,e+='</td></tr><tr><td style="width:150px; text-align:right;"> <strong>Başlık:</strong> </td><td class="text-left">'+(null==t.title?"":t.title)+'</td></tr><tr><td style="width:150px; text-align:right;"> <strong>Açıklama:</strong> </td><td class="text-left">'+(null==t.description?"":t.description)+"</td></tr>",""!=t.photo.photo&&(e+='<tr><td style="width:150px; text-align:right;"> <strong>Fotoğraf:</strong> </td><td class="text-left"><div class="col-lg-4 col-md-6 col-sm-6 col-xs-12"><div class="mt-element-overlay"><div class="mt-overlay-2"><img src="'+t.photo.photo+'"></div></div></div></td></tr>'),""!=t.video.video&&(e+='<tr><td style="width:150px; text-align:right;"> <strong>Video:</strong> </td><td class="text-left"><div class="col-lg-4 col-md-4 col-sm-6 col-xs-12"><div class="embed-responsive embed-responsive-16by9"><iframe class="embed-responsive-item" src="'+t.video.video+'"></iframe></div></div></td></tr>'),e+'<tr><td style="width:150px; text-align:right;"> <strong>Oluşturma Tarihi:</strong> </td><td class="text-left">'+t.created_at.display+'</td></tr><tr><td style="width:150px; text-align:right;"> <strong>Düzenleme Tarihi:</strong> </td><td class="text-left">'+t.updated_at.display+"</td></tr></tbody></table>"},exportOptions:{columns:[]},dataTable:{columns:[{data:"id",name:"id",className:"text-center"},{data:"media",name:"media",searchable:!1,orderable:!1,className:"text-center"},{data:"title",name:"title"},{data:"categories",name:"categories",orderable:!1,render:function(t,e,a,s){var i="";return $.each(t,function(t,e){i+='<a href="'+categoryURL.replace("###id###",e.id)+'"> '+e.name+" </a>, "}),i=i.substring(0,i.length-2)}},{data:"status",name:"is_publish",className:"text-center",render:function(t,e,a,s){return t?'<span class="label label-success"> Yayında </span>':'<span class="label label-danger"> Yayında Değil </span>'}},{data:{_:"created_at.display",sort:"created_at.timestamp"},name:"created_at",className:"text-center"},{data:"action",name:"action",searchable:!1,orderable:!1,className:"text-center",render:function(t,e,a,s){var i={id:a.id,showUrl:a.urls.show,buttons:[{title:'<i class="fa fa-pencil"></i> '+LMCApp.lang.admin.ops.fast_edit,attributes:{href:"#editor-modal","data-toggle":"modal","data-action":"fast-edit","data-id":a.id}},{title:'<i class="fa fa-pencil"></i> '+LMCApp.lang.admin.ops.edit,attributes:{href:a.urls.edit_page}},{title:'<i class="fa fa-trash"></i> '+LMCApp.lang.admin.ops.destroy,attributes:{href:"javascript:;","class":"fast-destroy"}},"divider"]};return i.buttons.push({title:a.status?'<i class="fa fa-times"></i> '+LMCApp.lang.admin.ops.not_publish:'<i class="fa fa-check"></i> '+LMCApp.lang.admin.ops.publish,attributes:{href:"javascript:;","class":a.status?"fast-not-publish":"fast-publish"}}),theDataTable.getActionMenu(i)}}],ajax:{url:ajaxURL}}},Editor:{modalShowCallback:function(t){var e=$("#photo"),a=$("#elfinder-photo"),s=$("#video"),i=$("#media_accordion"),n=$("#file-upload-management");"fast-edit"===t.actionType?(LMCFileinput.disable(e),a.prop("disabled",!0),s.prop("disabled",!0),i.hide(),n.hide()):(LMCFileinput.enable(e),a.prop("disabled",!1),s.prop("disabled",!1),i.show(),n.show())},actionButtonCallback:function(t){$script(formLoaderJs,"formLoader"),$script.ready(["formLoader","validation"],function(){$script(formJs,"form")}),$script.ready("form",function(){ModelForm.init({isAjax:!0,submitAjax:function(e){var a=$("#photo"),s=LMCFileinputs["#photo"].isEnable;if(a.length&&"fast-add"===t.actionType&&s)return void a.fileinput("upload");var i,n,l,o,r,d,p={category_id:null==e.form.find('select[name="category_id[]"]').val()?e.form.find('input[name="category_id[]"]').val():e.form.find('select[name="category_id[]"]').val(),title:e.form.find('input[name="title"]').val(),description:void 0==e.form.find('textarea[name="description"]').val()?"":e.form.find('textarea[name="description"]').val(),is_publish:e.form.find('input[name="is_publish"]').bootstrapSwitch("state")},c=$("#video");"fast-add"===t.actionType?(n="POST",i=apiStoreURL,l=LMCApp.lang.admin.flash.store_success.message,o=LMCApp.lang.admin.flash.store_success.title,r=LMCApp.lang.admin.flash.store_error.message,d=LMCApp.lang.admin.flash.store_error.title,c.prop("disabled")||void 0==c.prop("disabled")?p.photo=$("#elfinder-photo").val():p.video=c.val()):(n="PATCH",i=t.row.data().urls.edit,l=LMCApp.lang.admin.flash.update_success.message,o=LMCApp.lang.admin.flash.update_success.title,r=LMCApp.lang.admin.flash.update_error.message,d=LMCApp.lang.admin.flash.update_error.title),$.ajax({url:i,data:p,type:n,success:function(e){return"success"===e.result?(LMCApp.getNoty({message:l,title:o,type:"success"}),void t.modal.modal("hide")):void LMCApp.getNoty({message:r,title:d,type:"error"})}}).done(function(t){"success"===t.result&&(LMCApp.hasTransaction=!1,DataTable.dataTable.ajax.reload())})}}),$(t.editorOptions.formSrc).submit()})}},Fileinput:{src:"#photo",fileinput:ModelIndex.fileinputOptions}}}};